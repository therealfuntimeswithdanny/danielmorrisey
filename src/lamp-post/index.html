<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>AI Image Generator</title>
<script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-900 text-white min-h-screen flex flex-col items-center p-6">

<!-- Header -->
<header class="w-full max-w-5xl mb-6 flex justify-between items-center">
  <h1 class="text-2xl font-bold">AI Image Generator</h1>
  <div class="flex gap-2">
    <a href="login.html" class="text-red-500 hover:underline">Login</a>
    <a href="dashboard.html" class="text-red-500 hover:underline">Dashboard</a>
  </div>
</header>

<!-- Main Generate Card -->
<div class="w-full max-w-5xl mb-6">
  <div class="bg-gray-800 p-8 rounded-2xl shadow-lg flex flex-col gap-4 max-w-2xl mx-auto">
    <h2 class="text-xl font-semibold">Generate AI Image</h2>
    <form id="generateForm" class="flex gap-2">
      <input id="prompt" type="text" placeholder="Enter prompt..." 
        class="flex-1 p-3 rounded-lg text-black focus:outline-none" required>
      <button type="submit" class="px-4 py-2 bg-red-500 rounded-lg hover:bg-red-600">Generate</button>
    </form>
    <div id="loading" class="hidden mt-2 text-red-400 animate-pulse">Generating...</div>
    <div id="result" class="hidden mt-4 flex flex-col items-center gap-2">
      <img id="resultImg" class="rounded-xl shadow-lg w-full"/>
      <div class="flex gap-2">
        <a id="downloadBtn" target="_blank" class="px-4 py-1 bg-red-500 rounded hover:bg-red-600 text-sm">Download</a>
        <button id="copyBtn" class="px-4 py-1 bg-red-500 rounded hover:bg-red-600 text-sm">Copy Link</button>
      </div>
    </div>
  </div>
</div>

<!-- Secondary Cards Grid -->
<div class="w-full max-w-5xl grid grid-cols-1 md:grid-cols-2 gap-6">
  <!-- Example Info Card -->
  <div class="bg-gray-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-lg font-semibold mb-2">How it works</h2>
    <p class="text-gray-300 text-sm">Speed up image generation using IMRS & AI Cloudflare Workers.</p>
  </div>

  <!-- Placeholder / History Card -->
  <div class="bg-gray-800 p-6 rounded-2xl shadow-lg">
    <h2 class="text-lg font-semibold mb-2">Your History</h2>
    <p class="text-gray-300 text-sm">After logging in, your generated images will appear here.</p>
  </div>
</div>

<footer class="mt-8 text-gray-400 text-sm">
  Powered by Cloudflare Workers, <a href="/src/cdn/index.html" class="text-red-500 hover:underline">MBD CDN, MBD imrs</a> & MBD AI
</footer>

<script>
const API_BASE = "https://lamp-post.madebydannyuk.workers.dev";

document.getElementById("generateForm").addEventListener("submit", async (e) => {
  e.preventDefault();
  const prompt = document.getElementById("prompt").value;

  const loading = document.getElementById("loading");
  const result = document.getElementById("result");
  const resultImg = document.getElementById("resultImg");
  const downloadBtn = document.getElementById("downloadBtn");

  loading.classList.remove("hidden");
  result.classList.add("hidden");

  try {
    const res = await fetch(`${API_BASE}/api/generate`, {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ prompt }),
    });
    const data = await res.json();

    loading.classList.add("hidden");
    result.classList.remove("hidden");

    resultImg.src = data.imrs;
    downloadBtn.href = data.url;

    document.getElementById("copyBtn").onclick = () => {
      navigator.clipboard.writeText(data.imrs);
      alert("Image link copied!");
    };
  } catch(err) {
    console.error(err);
    alert("Something went wrong.");
    loading.classList.add("hidden");
  }
});
</script>

</body>
</html>
